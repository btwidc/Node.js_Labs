<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Lab14</title>
</head>
<body>
<div class="wrapper">
    <div class="getData">
        GET:
        <br />
        <br />
        <button onclick="get()">GET</button>
    </div>
    <div class="postData">
        <br />
        POST:
        <br />
        <br />
        <label>
            PULPIT:
            <input type="text" name="pulpit" id="pulpit" required />
        </label>
        <br />
        <label>
            PULPIT NAME:
            <input
                    type="text"
                    name="pulpit_name"
                    id="pulpit_name"
                    required
            />
        </label>
        <br />
        <label>
            FACULTY:
            <input type="text" name="faculty" id="faculty" required />
        </label>
        <br />
        <button onclick="post()">POST</button>
    </div>
    <div class="update-data">
        <br />
        UPDATE:
        <br />
        <br />
        <label>
            PULPIT:
            <input
                    type="text"
                    name="pulpit_update"
                    id="pulpit_update"
                    required
            />
        </label>
        <br />
            FACULTY:
            <input
                    type="text"
                    name="value_name"
                    id="faculty_value"
                    required
            />
        </label>
        <br />
        <div class="putData"></div>
        <button onclick="put()">PUT</button>
    </div>
    <br />
    <div class="deleteData">
        <br />
        DELETE:
        <br />
        <br />
        <label>
            PULPIT: <input type="text" name="pulpit" id="pulpit_del" required />
        </label>
        <button onclick="del()">DELETE</button>
    </div>
    <br />
    <div class="clear">
        <form>
            <button onclick="clear()">CLEAR</button>
        </form>
    </div>
    <div class="result"></div>
</div>
<script>
     const clear = () => {
        console.log("clear");
        document.querySelector(".result").innerHTML = "";
    }

    const jsonToString = (json) => {
        let str = "";
        for (let obj of json) {
            str += JSON.stringify(obj) + "<br>";
        }
        return str;
    }

    const get = () => {
        fetch("http://localhost:3000/api/pulpits", { method: "GET" })
            .then((response) => response.json())
            .then((data) => {
                document.querySelector(".result").innerHTML =
                    jsonToString(data);
            })
            .catch((err) => console.log(err));
    }

    const post = () => {
        const pulpit = document.querySelector("#pulpit").value;
        const pulpitName = document.querySelector("#pulpit_name").value;
        const faculty = document.querySelector("#faculty").value;
        fetch("http://localhost:3000/api/pulpits", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                Accept: "application/json",
            },
            body: JSON.stringify({
                ["PULPIT"]: pulpit,
                ["PULPIT_NAME"]: pulpitName,
                ["FACULTY"]: faculty,
            }),
        })
            .then((response) => response.json())
            .then((data) => {
                document.querySelector(".result").innerHTML = JSON.stringify(data);
            })
            .catch((err) => console.log(err));
    }

    const put = () => {
        const pulpit = document.querySelector("#pulpit_update").value;
        const faculty = document.querySelector("#faculty_value").value;
        fetch(`http://localhost:3000/api/pulpits/${pulpit}`, {
            method: "PUT",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                ["FACULTY"]: faculty,
            }),
        })
            .then((response) => response.json())
            .then((data) => {
                document.querySelector(".result").innerHTML = JSON.stringify(data);
            })
            .catch((err) => console.log(err));
    }

    function del() {
        const pulpit = document.querySelector("#pulpit_del").value;
        fetch(`http://localhost:3000/api/pulpits/${pulpit}`, {
            method: "DELETE",
        })
            .then((response) => response.text())
            .then((data) => {
                document.querySelector(".result").innerHTML = data;
            })
            .catch((err) => console.log(err));
    }

</script>
</body>
</html>
